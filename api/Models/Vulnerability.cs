namespace api.Models;

public class Vulnerability
{
    public int Id { get; set; }
    public string CveId { get; set; } = string.Empty;
    public string Title { get; set; } = string.Empty;
    public string Description { get; set; } = string.Empty;
    public string Severity { get; set; } = string.Empty;
    public double Score { get; set; }
    public double BioRelevanceScore { get; set; }
    public double PriorityScore { get; set; }
    public string Source { get; set; } = string.Empty;
    public string SourceCredibility { get; set; } = string.Empty;
    public string BiotechRelevance { get; set; } = string.Empty;
    public string BiologicalImpact { get; set; } = string.Empty;
    public string HumanImpact { get; set; } = string.Empty;
    public bool SoleSourceFlag { get; set; }
    public string DiscoveredDate { get; set; } = string.Empty;
    public string AffectedSystems { get; set; } = string.Empty; // JSON array stored as string
    public DateTime CreatedAt { get; set; } = DateTime.UtcNow;
    
    // AI Rating fields
    public double AiRating { get; set; } // Original AI rating
    public double? UserRating { get; set; } // User-modified rating (null if not changed)
    public bool IsReviewed { get; set; } // Whether user has reviewed this threat
    public DateTime? ReviewedAt { get; set; } // When it was reviewed
}

